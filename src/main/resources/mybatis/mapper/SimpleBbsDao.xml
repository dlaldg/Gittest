<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- SQL 끝에 ; 세미콜론을 넣지 마세요! -->

<mapper namespace="com.study.Ex09_Mybatis.dao.ISimpleBbsDao"> 

	<select id="listDao" resultType="com.study.Ex09_Mybatis.dto.SimpleBbsDto"> 
		select * from simple_bbs order by id desc
	</select>

	<select id="viewDao" resultType="com.study.Ex09_Mybatis.dto.SimpleBbsDto"> 
		select * from simple_bbs where id = #{param1}
	</select>
	
	
	<!-- MySQL 방식 -->
	<!-- MyBatis insert 후 PK(auto_increment)값 바로 가져오기 -->
	<!-- MySQL : useGeneratedKeys - auto increment 기능 사용 -->
	<!--         keyProperty - AI 매칭되는 키   -->
	<insert id="writeDao_mySQL" useGeneratedKeys="true" keyProperty="id">
      insert into simple_bbs (id, writer, title, content)
           values (simple_bbs_seq.nextval, #{param1}, #{param2}, #{param3})
   </insert>
   
   <!-- Oracle : 방식1 -->
   <insert id="writeDto" parameterType="com.study.Ex09_Mybatis.dto.SimpleBbsDto">
      insert into simple_bbs (id, writer, title, content)
           values (simple_bbs_seq.nextval, #{writer}, #{title}, #{content})
   </insert>
	<!-- 멤버변수이름으로도 가능 :  parameterType을 입력해줘야 됨. -->
   
   <!-- Oracle : 방식2 -->
   <insert id="writeDao">
	  <selectKey keyProperty="id" resultType="int" order="BEFORE">
	        select simple_bbs_seq.nextval FROM DUAL
	  </selectKey>
      insert into simple_bbs (id, writer, title, content)
           values (#{id}, #{param1}, #{param2}, #{param3})
   </insert>

	<delete id="deleteDao">
		delete from simple_bbs where id = #{param1}
	</delete>
	
	<update id="updateDao">
		update simple_bbs set writer = #{param2}, title = #{param3}, 
		     content = #{param4} WHERE id = #{param1}
	</update>
	
</mapper>